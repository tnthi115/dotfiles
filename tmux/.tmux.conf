# vim:foldmethod=marker:foldlevel=0

# ----------------------------=== General ===------------------------- {{{
# Title window
set -g set-titles on
set -g set-titles-string "#T"

# Terminal colors
set -ga terminal-overrides ",xterm-256color*:Tc"
set -g default-terminal "xterm-256color"
set-environment -g COLORTERM "truecolor"
set -s escape-time 0

# Switch to another existing session when you close the final window of the current session.
set-option -g detach-on-destroy off

# Remap prefix from 'C-b' to 'C-e' because 'C-b' is too much of a stretch on
# QWERTY. 'C-a' is also very common.
unbind C-b
set-option -g prefix C-e
bind-key C-e send-prefix

# Split panes using | and - and to open in the current directory.
bind | split-window -h -c "#{pane_current_path}"
bind - split-window -v -c "#{pane_current_path}"
unbind '"'
unbind %
# bind '"' split-window -c "#{pane_current_path}"
# bind % split-window -h -c "#{pane_current_path}"

# Set new window to open in current directory.
bind c new-window -c "#{pane_current_path}"

# Reload config file (change file location to your the tmux.conf you want to use).
bind-key r source-file ~/.tmux.conf \; display-message "~/.tmux.conf reloaded"

# vim-like pane switching
bind -r ^ last-window
bind -r k select-pane -U
bind -r j select-pane -D
bind -r h select-pane -L
bind -r l select-pane -R

# Enable mouse mode (tmux 2.1 and above)
set -g mouse on

# Enable vi keybindings.
set-window-option -g mode-keys vi
# set-window-option -g xterm-keys on
bind -T copy-mode-vi v send-keys -X begin-selection
bind -T copy-mode-vi y send-keys -X copy-pipe-and-cancel 'xclip -in -selection clipboard'

# Interactive pane joining.
bind-key m choose-window -F "#{window_index}: #{window_name}" "join-pane -v -t %%"
bind-key M choose-window -F "#{window_index}: #{window_name}" "join-pane -h -t %%"

# bind y run -b "tmux show-buffer | xclip -in -selection clipboard"\; display-message "copied tmux buffer to system clipboard"

# Start windows and panes at 1, not 0
set -g base-index 1
set -g pane-base-index 1

# Popup window to switch sessions with fzf
bind-key o display-popup -E "tmux switch-client -t \$(tmux ls | fzf | awk '{print \$1}')"

# -----------------=== The primeagen config stuff ===----------------- {{{
# bind -r D neww -c "#{pane_current_path}" "[[ -e TODO.md ]] && nvim TODO.md || nvim ~/.dotfiles/personal/todo.md"

# # forget the find window.  That is for chumps
# bind-key -r f run-shell "tmux neww ~/.local/bin/tmux-sessionizer"

# bind-key -r i run-shell "tmux neww tmux-cht.sh"
# bind-key -r G run-shell "~/.local/bin/tmux-sessionizer ~/work/nrdp"
# bind-key -r C run-shell "~/.local/bin/tmux-sessionizer ~/work/tvui"
# bind-key -r R run-shell "~/.local/bin/tmux-sessionizer ~/work/milo"
# # bind-key -r L run-shell "~/.local/bin/tmux-sessionizer ~/work/hpack"
# bind-key -r H run-shell "~/.local/bin/tmux-sessionizer ~/personal/vim-with-me"
# bind-key -r T run-shell "~/.local/bin/tmux-sessionizer ~/personal/refactoring.nvim"
# bind-key -r N run-shell "~/.local/bin/tmux-sessionizer ~/personal/harpoon"
# bind-key -r S run-shell "~/.local/bin/tmux-sessionizer ~/personal/developer-productivity"

# }}}

# }}}

# ----------------------------=== Colors ===-------------------------- {{{

# NOTE: you can use vars with $<var> and ${<var>} as long as the str is double quoted: ""
# WARNING: hex colors can't contain capital letters

# TODO: update colors to grab colors from the terminal (reference neofetch.conf)

# # --> Catppuccin
# thm_bg="#1e1e2e"
# thm_fg="#cdd6f4"
# thm_gray="#bac2de"
# thm_cyan="#9399b2"
# thm_magenta="#9399b2"
# thm_pink="#f5c2e7"
# thm_red="#f38ba8"
# thm_green="#a6e3a1"
# thm_blue="#89b4fa"
# thm_orange="#fab387"
# thm_black="#181825"
# thm_black4="#11111b"

# # --> Gruvbox Dark
# thm_bg="#32302f"
# # thm_bg="#504945"
# # thm_fg="#c5c8c6"
# # thm_fg="#ebdbb2"
# # thm_fg="#d4be98"
# thm_fg="#e2cca9"
# thm_gray="#928374"
# thm_cyan="#689d6a"
# thm_magenta="#b16286"
# thm_pink="#d3869b"
# thm_red="#cc241d"
# thm_green="#98971a"
# thm_blue="#458588"
# thm_orange="#d79921"
# thm_black="#282828"
# # thm_black="#010101"
# # thm_black4="#928374"
# thm_black4="#111111"
# thm_white="#a89984"

# --> Gruvbox Material Dark
# thm_bg="#32302f"
# # thm_bg="#504945"
# # thm_fg="#c5c8c6"
# # thm_fg="#ebdbb2"
# # thm_fg="#d4be98"
# thm_fg="#e2cca9"
# thm_gray="#928374"
# thm_cyan="#8bba7f"
# thm_magenta="#d3869b"
# thm_pink="#d3869b"
# thm_red="#f2594b"
# thm_green="#b0b846"
# thm_blue="#80aa9e"
# thm_orange="#e3a84e"
# # thm_black="#282828"
# thm_black="#1d2021"
# # thm_black="#010101"
# # thm_black4="#928374"
# thm_black4="#111111"
# thm_white="#a89984"

# # --> Tokyonight Night
thm_bg="#1a1b26"
thm_fg="#a9b1d6"
thm_gray="#545c7e"
thm_cyan="#7dcfff"
# thm_cyan="#27a1b9"
thm_magenta="#bb9af7"
thm_pink="#ebbcba"
thm_red="#f7768e"
thm_green="#9ece6a"
thm_blue="#7aa2f7"
thm_orange="#ff9e64"
thm_black="#1a1b26"
thm_black4="#16161e"
thm_white="#c0caf5"

# # --> Rose Pine Moon
# # thm_bg="#232136"
# thm_bg="#393552"
# thm_fg="#e0def4"
# thm_gray="#6e6a86"
# thm_cyan="#ea9a97"
# thm_magenta="#c4a7e7"
# thm_pink="#d3869b"
# thm_red="#eb6f92"
# thm_green="#3e8fb0"
# thm_blue="#9ccfd8"
# thm_orange="#f6c177"
# # thm_black="#393552"
# thm_black="#232136"
# thm_black4="#2a273f"
# thm_white="#e0def4"

# # --> Rose Pine Main
# # thm_bg="#191724"
# thm_bg="#26233a"
# thm_fg="#e0def4"
# thm_gray="#6e6a86"
# thm_cyan="#ebbcba"
# thm_magenta="#c4a7e7"
# thm_pink="#d3869b"
# thm_red="#eb6f92"
# thm_green="#31748f"
# thm_blue="#9ccfd8"
# thm_orange="#f6c177"
# # thm_black="#26233a"
# thm_black="#191724"
# thm_black4="#2a273f"
# thm_white="#e0def4"

# }}}

# ----------------------------=== Theme ===--------------------------- {{{

# status
set -g status-interval 1
set -g escape-time 10
set -g focus-events on
set -g status "on"
# set -g status-bg "${thm_black}"
# transparent background
set-option -g status-style bg=default
set -g status-justify "left"
set -g status-left-length "100"
set -g status-right-length "100"

# messages
set -g message-style fg="${thm_cyan}",bg="${thm_black}",align="centre"
set -g message-command-style fg="${thm_cyan}",bg="${thm_black}",align="centre"

# panes
set -g pane-border-style fg="${thm_black}"
set -g pane-active-border-style fg="${thm_blue}"

# windows
# setw -g window-status-activity-style fg="${thm_fg}",bg="${thm_bg}",none
setw -g window-status-activity-style fg="${thm_fg}",bg=default,none
setw -g window-status-separator ""
# setw -g window-status-style fg="${thm_fg}",bg="${thm_bg}",none
setw -g window-status-style fg="${thm_fg}",bg=default,none

# statusline:  - path,  - session,  󰃰 - date and time
statusline_path=
statusline_session=
statusline_date=󰃰

# for some reason when set to top it is no longer transparent
# set-option -g status-position top
set-option -g status-position bottom
set -g status-left ""
# set -g status-right "#[fg=$thm_pink,bg=$thm_black,nobold,nounderscore,noitalics] #[fg=$thm_bg,bg=$thm_pink,nobold,nounderscore,noitalics]  #[fg=$thm_fg,bg=$thm_black] #W #{?client_prefix,#[fg=$thm_red],#[fg=$thm_green]}#[bg=$thm_black] #{?client_prefix,#[bg=$thm_red],#[bg=$thm_green]}#[fg=$thm_bg] $statusline_session #[fg=$thm_fg,bg=$thm_black] #S #[fg=$thm_blue,bg=$thm_black,nobold,nounderscore,noitalics] #[fg=$thm_bg,bg=$thm_blue,nobold,nounderscore,noitalics] $statusline_date #[fg=$thm_fg,bg=$thm_black] %Y-%m-%d %H:%M "
# show truncated path
# set -g status-right "#[fg=$thm_magenta,bg=$thm_black,nobold,nounderscore,noitalics] #[fg=$thm_bg,bg=$thm_magenta,nobold,nounderscore,noitalics]  #[fg=$thm_fg,bg=$thm_black] #{b:pane_current_path} #{?client_prefix,#[fg=$thm_red],#[fg=$thm_green]}#[bg=$thm_black] #{?client_prefix,#[bg=$thm_red],#[bg=$thm_green]}#[fg=$thm_bg] $statusline_session #[fg=$thm_fg,bg=$thm_black] #S #[fg=$thm_blue,bg=$thm_black,nobold,nounderscore,noitalics] #[fg=$thm_bg,bg=$thm_blue,nobold,nounderscore,noitalics] $statusline_date #[fg=$thm_fg,bg=$thm_black] %Y-%m-%d %H:%M "
# show full path
# set -g status-right "#[fg=$thm_magenta,bg=$thm_black,nobold,nounderscore,noitalics] #[fg=$thm_bg,bg=$thm_magenta,nobold,nounderscore,noitalics]  #[fg=$thm_fg,bg=$thm_black] #{pane_current_path} #{?client_prefix,#[fg=$thm_red],#[fg=$thm_green]}#[bg=$thm_black] #{?client_prefix,#[bg=$thm_red],#[bg=$thm_green]}#[fg=$thm_bg] $statusline_session #[fg=$thm_fg,bg=$thm_black] #S #[fg=$thm_blue,bg=$thm_black,nobold,nounderscore,noitalics] #[fg=$thm_bg,bg=$thm_blue,nobold,nounderscore,noitalics] $statusline_date #[fg=$thm_fg,bg=$thm_black] %Y-%m-%d %H:%M"
# set -g status-right "#[fg=$thm_magenta,bg=$thm_black,nobold,nounderscore,noitalics] #[fg=$thm_bg,bg=$thm_magenta,nobold,nounderscore,noitalics] $statusline_path #[fg=$thm_fg,bg=$thm_black] #{s|/home/user|~|:pane_current_path} #{?client_prefix,#[fg=$thm_red],#[fg=$thm_green]}#[bg=$thm_black] #{?client_prefix,#[bg=$thm_red],#[bg=$thm_green]}#[fg=$thm_bg] $statusline_session #[fg=$thm_fg,bg=$thm_black] #S #[fg=$thm_blue,bg=$thm_black,nobold,nounderscore,noitalics] #[fg=$thm_bg,bg=$thm_blue,nobold,nounderscore,noitalics] $statusline_date #[fg=$thm_fg,bg=$thm_black] %Y-%m-%d %H:%M"
# set -g status-right "#[fg=$thm_magenta,bg=default,nobold,nounderscore,noitalics] #[fg=$thm_bg,bg=$thm_magenta,nobold,nounderscore,noitalics] $statusline_path #[fg=$thm_fg,bg=default] #{s|/home/user|~|:pane_current_path} #{?client_prefix,#[fg=$thm_red],#[fg=$thm_green]}#[bg=default] #{?client_prefix,#[bg=$thm_red],#[bg=$thm_green]}#[fg=$thm_bg] $statusline_session #[fg=$thm_fg,bg=default] #S #[fg=$thm_blue,bg=default,nobold,nounderscore,noitalics] #[fg=$thm_bg,bg=$thm_blue,nobold,nounderscore,noitalics] $statusline_date #[fg=$thm_fg,bg=default] %Y-%m-%d %H:%M"
# without time
set -g status-right "#[fg=$thm_magenta,bg=$thm_black,nobold,nounderscore,noitalics] #[fg=$thm_bg,bg=$thm_magenta,nobold,nounderscore,noitalics]  #[fg=$thm_fg,bg=$thm_black] #{pane_current_path} #{?client_prefix,#[fg=$thm_red],#[fg=$thm_blue]}#[bg=$thm_black] #{?client_prefix,#[bg=$thm_red],#[bg=$thm_green]}#[fg=$thm_bg] $statusline_session #[fg=$thm_fg,bg=$thm_black] #S"

# current_dir
# setw -g window-status-format "#[fg=$thm_bg,bg=$thm_cyan] #I #[fg=$thm_gray,bg=$thm_black] #{b:pane_current_path} "
# setw -g window-status-current-format "#[fg=$thm_bg,bg=$thm_orange] #I #[fg=$thm_fg,bold,bg=$thm_bg] #{b:pane_current_path} "

# window names, default is current program
# setw -g window-status-format "#[fg=$thm_bg,bg=$thm_cyan] #I #[fg=$thm_gray,bg=$thm_black] #W "
# setw -g window-status-current-format "#[fg=$thm_bg,bg=$thm_orange] #I #[fg=$thm_fg,bold,bg=$thm_bg] #W "
# setw -g window-status-format "#[fg=$thm_bg,bg=$thm_orange] #I #[fg=$thm_gray,bg=$thm_black] #W "
setw -g window-status-format "#[fg=$thm_bg,bg=$thm_orange] #I #[fg=$thm_gray,bg=default] #W "
# setw -g window-status-current-format "#[fg=$thm_bg,bg=$thm_cyan] #I #[fg=$thm_cyan,bold,bg=$thm_bg] #W "
# setw -g window-status-current-format "#[fg=$thm_bg,bg=$thm_cyan] #I #[fg=$thm_cyan,bold,bg=$thm_black] #W "
# setw -g window-status-current-format "#[fg=$thm_bg,bg=$thm_cyan] #I #[fg=$thm_cyan,bold,bg=default] #W "
setw -g window-status-current-format "#[fg=$thm_bg,bg=$thm_blue] #I #[fg=$thm_blue,bold,bg=$thm_black] #W "

# modes
setw -g clock-mode-colour "${thm_blue}"
setw -g mode-style "fg=${thm_pink} bg=${thm_black} bold"

# }}}

# ---------------------------=== PLUGINS ===-------------------------- {{{

# To install Tmux Plugin Manager (TPM):
# git clone https://github.com/tmux-plugins/tpm ~/.tmux/plugins/tpm

# List of plugins
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-sensible'

# Other examples:
# set -g @plugin 'github_username/plugin_name'
# set -g @plugin 'github_username/plugin_name#branch'
# set -g @plugin 'git@github.com:user/plugin'
# set -g @plugin 'git@bitbucket.com:user/plugin'

# Smart tmux session manager
# prerequisites:
# - zoxide: curl -sS https://raw.githubusercontent.com/ajeetdsouza/zoxide/main/install.sh | bash
# - fzf
# set -g @plugin 'joshmedeski/t-smart-tmux-session-manager'

# tmux-resurrect
set -g @plugin 'tmux-plugins/tmux-resurrect'
# tmux-continuum
set -g @plugin 'tmux-plugins/tmux-continuum'

# Automatic restore
set -g @continuum-restore 'on'

# Reload nvim session in tmux-resurrect.
set -g @resurrect-strategy-nvim 'session'

# Initialize Tmux Plugin Manager (keep this line at the very bottom of tmux.conf)
run '~/.tmux/plugins/tpm/tpm'

# }}}
